/**
 * @file Firestore Security Rules for Blue Square AI Contact Form Submissions.
 * @core_philosophy This ruleset allows unauthenticated users to submit contact forms while restricting read access to authenticated admins to prevent unauthorized data access.
 * @data_structure Contact form submissions are stored in a top-level collection: /contactFormSubmissions/{contactFormSubmissionId}.
 * @key_security_decisions Unauthenticated create operations are allowed, as submissions are collected from a public-facing form. Read operations are explicitly allowed only for authenticated users (admins). Listing is also restricted to authenticated users.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Controls access to contact form submissions.
     * @path /contactFormSubmissions/{contactFormSubmissionId}
     * @allow (create) - Any unauthenticated user can submit a contact form.
     * @allow (get, list) - Only authenticated users (admins) can read or list contact forms.
     * @deny (update, delete) - No user can update or delete a contact form.
     */
    match /contactFormSubmissions/{contactFormSubmissionId} {
      allow get: if request.auth != null;
      allow list: if request.auth != null;
      allow create: if true;
      allow update: if false;
      allow delete: if false;
    }
  }
}
